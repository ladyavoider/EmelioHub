local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ESPHelper"
screenGui.Parent = game.CoreGui
screenGui.ResetOnSpawn = false

local windowFrame = Instance.new("Frame")
windowFrame.Name = "Window"
windowFrame.Size = UDim2.new(0,     500,     0,     400)
windowFrame.Position = UDim2.new(0.5,     -250,     0.5,     -200)
windowFrame.BackgroundColor3 = Color3.fromRGB(30,     30,     30)
windowFrame.BorderSizePixel = 0
windowFrame.Active = true
windowFrame.Draggable = true
windowFrame.Parent = screenGui

local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1,     0,     0,     30)
titleBar.Position = UDim2.new(0,     0,     0,     0)
titleBar.BackgroundColor3 = Color3.fromRGB(40,     40,     40)
titleBar.Parent = windowFrame

local titleText = Instance.new("TextLabel")
titleText.Name = "Title"
titleText.Size = UDim2.new(1,     -90,     1,     0)
titleText.Position = UDim2.new(0,     10,     0,     0)
titleText.BackgroundTransparency = 1
titleText.Text = "ESP & Hitbox"
titleText.TextColor3 = Color3.fromRGB(255,     255,     255)
titleText.TextSize = 16
titleText.Font = Enum.Font.SourceSansSemibold
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Parent = titleBar

local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "MinimizeButton"
minimizeButton.Size = UDim2.new(0,     20,     0,     20)
minimizeButton.Position = UDim2.new(1,     -55,     0,     5)
minimizeButton.BackgroundColor3 = Color3.fromRGB(70,     70,     70)
minimizeButton.Text = "_"
minimizeButton.TextColor3 = Color3.fromRGB(255,     255,     255)
minimizeButton.TextSize = 14
minimizeButton.Font = Enum.Font.SourceSansBold
minimizeButton.Parent = titleBar

local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0,     20,     0,     20)
closeButton.Position = UDim2.new(1,     -30,     0,     5)
closeButton.BackgroundColor3 = Color3.fromRGB(200,     0,     0)
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255,     255,     255)
closeButton.TextSize = 14
closeButton.Font = Enum.Font.SourceSansBold
closeButton.Parent = titleBar

local tabContainer = Instance.new("Frame")
tabContainer.Name = "TabContainer"
tabContainer.Size = UDim2.new(1,     0,     0,     40)
tabContainer.Position = UDim2.new(0,     0,     0,     30)
tabContainer.BackgroundColor3 = Color3.fromRGB(50,     50,     50)
tabContainer.BorderSizePixel = 0
tabContainer.Parent = windowFrame

local contentArea = Instance.new("Frame")
contentArea.Name = "ContentArea"
contentArea.Size = UDim2.new(1,     0,     1,     -70)
contentArea.Position = UDim2.new(0,     0,     0,     70)
contentArea.BackgroundTransparency = 1
contentArea.Parent = windowFrame

local tabs = {}
local currentTab = nil
local isMinimized = false

minimizeButton.MouseButton1Click:   Connect(function()
    isMinimized = not isMinimized
    if isMinimized then
        contentArea.Visible = false
        tabContainer.Visible = false
        windowFrame.Size = UDim2.new(0,     500,     0,     30)
        minimizeButton.Text = ""
    else
        contentArea.Visible = true
        tabContainer.Visible = true
        windowFrame.Size = UDim2.new(0,     500,     0,     400)
        minimizeButton.Text = "_"
    end
end)

closeButton.MouseButton1Click:   Connect(function()
    screenGui:   Destroy()
end)

local function createTab(name)
    local tabButton = Instance.new("TextButton")
    tabButton.Name = name .. "Tab"
    tabButton.Size = UDim2.new(0,     120,     1,     -10)
    tabButton.Position = UDim2.new(0,     10 + (#tabs * 130),     0,     5)
    tabButton.BackgroundColor3 = Color3.fromRGB(70,     70,     70)
    tabButton.Text = name
    tabButton.TextColor3 = Color3.fromRGB(200,     200,     200)
    tabButton.TextSize = 14
    tabButton.Font = Enum.Font.SourceSans
    tabButton.Parent = tabContainer
    
    local tabContent = Instance.new("Frame")
    tabContent.Name = name .. "Content"
    tabContent.Size = UDim2.new(1,     -20,     1,     -20)
    tabContent.Position = UDim2.new(0,     10,     0,     10)
    tabContent.BackgroundTransparency = 1
    tabContent.Visible = false
    tabContent.Parent = contentArea
    
    local uiStroke = Instance.new("UIStroke")
    uiStroke.Color = Color3.fromRGB(100,     100,     100)
    uiStroke.Thickness = 1
    uiStroke.Parent = tabButton
    
    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(0,     5)
    uiCorner.Parent = tabButton
    
    tabs[name] = {
        button = tabButton,     
        content = tabContent
    }
    
    tabButton.MouseButton1Click:   Connect(function()
        if currentTab then
            tabs[currentTab].button.BackgroundColor3 = Color3.fromRGB(70,     70,     70)
            tabs[currentTab].content.Visible = false
        end
        
        tabButton.BackgroundColor3 = Color3.fromRGB(90,     90,     90)
        tabContent.Visible = true
        currentTab = name
    end)
    
    return tabContent
end

local mainTab = createTab("Main")

local espEnabled = false
local boxESPEnabled = true
local nameESPEnabled = true
local distanceESPEnabled = true
local espObjects = {}

local hitboxEnabled = false
local hitboxSize = Vector3.new(4,     6,     1)
local hitboxTransparency = 0.5

-- Aimbot variables
local aimbotEnabled = false
local aimbotTarget = nil
local aimbotDistance = 50
local aimbotSpeed = 0.1

local function createESP(player)
    if player == game.Players.LocalPlayer then return end
    
    local espFolder = Instance.new("Folder")
    espFolder.Name = player.Name .. "_ESP"
    
    local box = Instance.new("BoxHandleAdornment")
    box.Name = "Box"
    box.Size = hitboxSize
    box.Color3 = Color3.fromRGB(255,     0,     0)
    box.Transparency = hitboxTransparency
    box.ZIndex = 10
    box.AlwaysOnTop = true
    box.Visible = false
    box.Parent = espFolder
    
    local nameTag = Instance.new("BillboardGui")
    nameTag.Name = "NameTag"
    nameTag.Size = UDim2.new(0,     100,     0,     50)
    nameTag.StudsOffset = Vector3.new(0,     3,     0)
    nameTag.AlwaysOnTop = true
    nameTag.Enabled = false
    
    local nameText = Instance.new("TextLabel")
    nameText.Size = UDim2.new(1,     0,     1,     0)
    nameText.BackgroundTransparency = 1
    nameText.TextColor3 = Color3.fromRGB(255,     255,     255)
    nameText.TextStrokeTransparency = 0
    nameText.TextSize = 14
    nameText.Font = Enum.Font.SourceSansBold
    nameText.Text = player.Name
    nameText.Parent = nameTag
    
    nameTag.Parent = espFolder
    
    local distanceTag = Instance.new("BillboardGui")
    distanceTag.Name = "DistanceTag"
    distanceTag.Size = UDim2.new(0,     100,     0,     50)
    distanceTag.StudsOffset = Vector3.new(0,     2,     0)
    distanceTag.AlwaysOnTop = true
    distanceTag.Enabled = false
    
    local distanceText = Instance.new("TextLabel")
    distanceText.Size = UDim2.new(1,     0,     1,     0)
    distanceText.BackgroundTransparency = 1
    distanceText.TextColor3 = Color3.fromRGB(255,     255,     0)
    distanceText.TextStrokeTransparency = 0
    distanceText.TextSize = 12
    distanceText.Font = Enum.Font.SourceSans
    distanceText.Text = ""
    distanceText.Parent = distanceTag
    
    distanceTag.Parent = espFolder
    
    espFolder.Parent = workspace.CurrentCamera
    
    espObjects[player] = {
        box = box,     
        nameTag = nameTag,     
        distanceTag = distanceTag,     
        distanceText = distanceText
    }
end

local function updateESP()
    if not espEnabled then return end
    
    local camera = workspace.CurrentCamera
    local localPlayer = game.Players.LocalPlayer
    
    if not localPlayer.Character or not localPlayer.Character:   FindFirstChild("HumanoidRootPart") then return end
    local localRoot = localPlayer.Character.HumanoidRootPart
    
    for player,     esp in pairs(espObjects) do
        if player and player.Character and player.Character:   FindFirstChild("HumanoidRootPart") and player.Character:   FindFirstChild("Head") then
            local rootPart = player.Character.HumanoidRootPart
            local head = player.Character.Head
            
            esp.box.Adornee = rootPart
            esp.box.Visible = boxESPEnabled
            
            esp.nameTag.Adornee = head
            esp.nameTag.Enabled = nameESPEnabled
            
            if distanceESPEnabled then
                local distance = (localRoot.Position - rootPart.Position).Magnitude
                esp.distanceText.Text = math.floor(distance + 0.5) .. " studs"
                esp.distanceTag.Adornee = head
                esp.distanceTag.Enabled = true
            else
                esp.distanceTag.Enabled = false
            end
        else
            esp.box.Visible = false
            esp.nameTag.Enabled = false
            esp.distanceTag.Enabled = false
        end
    end
end

local function removeESP(player)
    if espObjects[player] then
        espObjects[player].box:   Destroy()
        espObjects[player].nameTag:   Destroy()
        espObjects[player].distanceTag:   Destroy()
        espObjects[player] = nil
    end
end

-- Aimbot functions
local function findNearestTarget()
    local localPlayer = game.Players.LocalPlayer
    if not localPlayer.Character or not localPlayer.Character: FindFirstChild("HumanoidRootPart") then return nil end
    
    local localRoot = localPlayer.Character.HumanoidRootPart
    local nearestTarget = nil
    local nearestDistance = math.huge
    
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= localPlayer and player.Character and player.Character: FindFirstChild("HumanoidRootPart") then
            local targetRoot = player.Character.HumanoidRootPart
            local distance = (localRoot.Position - targetRoot.Position).Magnitude
            
            if distance <= aimbotDistance and distance < nearestDistance then
                nearestTarget = player
                nearestDistance = distance
            end
        end
    end
    
    return nearestTarget
end

local function aimAtTarget(target)
    if not target or not target.Character or not target.Character: FindFirstChild("Head") then return end
    
    local camera = workspace.CurrentCamera
    local targetHead = target.Character.Head
    local targetPosition = targetHead.Position
    
    -- Smoothly rotate camera towards target
    local currentCFrame = camera.CFrame
    local lookAtCFrame = CFrame.new(currentCFrame.Position, targetPosition)
    
    -- Interpolate between current and target rotation for smooth movement
    camera.CFrame = currentCFrame:Lerp(lookAtCFrame, aimbotSpeed)
end

-- Main aimbot loop
spawn(function()
    while wait(0.05) do
        if aimbotEnabled then
            aimbotTarget = findNearestTarget()
            if aimbotTarget then
                aimAtTarget(aimbotTarget)
            end
        end
    end
end)

local espToggleLabel = Instance.new("TextLabel")
espToggleLabel.Size = UDim2.new(0,     150,     0,     30)
espToggleLabel.Position = UDim2.new(0,     0,     0,     0)
espToggleLabel.BackgroundTransparency = 1
espToggleLabel.Text = "ESP Enabled:     "
espToggleLabel.TextColor3 = Color3.fromRGB(220,     220,     220)
espToggleLabel.TextSize = 14
espToggleLabel.Font = Enum.Font.SourceSans
espToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
espToggleLabel.Parent = mainTab

local espToggleButton = Instance.new("TextButton")
espToggleButton.Size = UDim2.new(0,     80,     0,     30)
espToggleButton.Position = UDim2.new(0,     160,     0,     0)
espToggleButton.BackgroundColor3 = Color3.fromRGB(150,     0,     0)
espToggleButton.Text = "OFF"
espToggleButton.TextColor3 = Color3.fromRGB(255,     255,     255)
espToggleButton.TextSize = 14
espToggleButton.Font = Enum.Font.SourceSans

local espToggleCorner = Instance.new("UICorner")
espToggleCorner.CornerRadius = UDim.new(0,     5)
espToggleCorner.Parent = espToggleButton

local espToggleStroke = Instance.new("UIStroke")
espToggleStroke.Color = Color3.fromRGB(100,     100,     100)
espToggleStroke.Thickness = 1
espToggleStroke.Parent = espToggleButton

espToggleButton.Parent = mainTab

espToggleButton.MouseButton1Click:   Connect(function()
    espEnabled = not espEnabled
    espToggleButton.Text = espEnabled and "ON" or "OFF"
    espToggleButton.BackgroundColor3 = espEnabled and Color3.fromRGB(0,     150,     0) or Color3.fromRGB(150,     0,     0)
    
    if espEnabled then
        for _,     player in ipairs(game.Players:   GetPlayers()) do
            createESP(player)
        end
    else
        for _,     esp in pairs(espObjects) do
            esp.box.Visible = false
            esp.nameTag.Enabled = false
            esp.distanceTag.Enabled = false
        end
    end
end)

local boxToggleLabel = Instance.new("TextLabel")
boxToggleLabel.Size = UDim2.new(0,     150,     0,     30)
boxToggleLabel.Position = UDim2.new(0,     0,     0,     40)
boxToggleLabel.BackgroundTransparency = 1
boxToggleLabel.Text = "Box ESP:     "
boxToggleLabel.TextColor3 = Color3.fromRGB(220,     220,     220)
boxToggleLabel.TextSize = 14
boxToggleLabel.Font = Enum.Font.SourceSans
boxToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
boxToggleLabel.Parent = mainTab

local boxToggleButton = Instance.new("TextButton")
boxToggleButton.Size = UDim2.new(0,     80,     0,     30)
boxToggleButton.Position = UDim2.new(0,     160,     0,     40)
boxToggleButton.BackgroundColor3 = Color3.fromRGB(0,     150,     0)
boxToggleButton.Text = "ON"
boxToggleButton.TextColor3 = Color3.fromRGB(255,     255,     255)
boxToggleButton.TextSize = 14
boxToggleButton.Font = Enum.Font.SourceSans

local boxToggleCorner = Instance.new("UICorner")
boxToggleCorner.CornerRadius = UDim.new(0,     5)
boxToggleCorner.Parent = boxToggleButton

local boxToggleStroke = Instance.new("UIStroke")
boxToggleStroke.Color = Color3.fromRGB(100,     100,     100)
boxToggleStroke.Thickness = 1
boxToggleStroke.Parent = boxToggleButton

boxToggleButton.Parent = mainTab

boxToggleButton.MouseButton1Click:   Connect(function()
    boxESPEnabled = not boxESPEnabled
    boxToggleButton.Text = boxESPEnabled and "ON" or "OFF"
    boxToggleButton.BackgroundColor3 = boxESPEnabled and Color3.fromRGB(0,     150,     0) or Color3.fromRGB(150,     0,     0)
end)

local nameToggleLabel = Instance.new("TextLabel")
nameToggleLabel.Size = UDim2.new(0,     150,     0,     30)
nameToggleLabel.Position = UDim2.new(0,     0,     0,     80)
nameToggleLabel.BackgroundTransparency = 1
nameToggleLabel.Text = "Name ESP:     "
nameToggleLabel.TextColor3 = Color3.fromRGB(220,     220,     220)
nameToggleLabel.TextSize = 14
nameToggleLabel.Font = Enum.Font.SourceSans
nameToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
nameToggleLabel.Parent = mainTab

local nameToggleButton = Instance.new("TextButton")
nameToggleButton.Size = UDim2.new(0,     80,     0,     30)
nameToggleButton.Position = UDim2.new(0,     160,     0,     80)
nameToggleButton.BackgroundColor3 = Color3.fromRGB(0,     150,     0)
nameToggleButton.Text = "ON"
nameToggleButton.TextColor3 = Color3.fromRGB(255,     255,     255)
nameToggleButton.TextSize = 14
nameToggleButton.Font = Enum.Font.SourceSans

local nameToggleCorner = Instance.new("UICorner")
nameToggleCorner.CornerRadius = UDim.new(0,     5)
nameToggleCorner.Parent = nameToggleButton

local nameToggleStroke = Instance.new("UIStroke")
nameToggleStroke.Color = Color3.fromRGB(100,     100,     100)
nameToggleStroke.Thickness = 1
nameToggleStroke.Parent = nameToggleButton

nameToggleButton.Parent = mainTab

nameToggleButton.MouseButton1Click:   Connect(function()
    nameESPEnabled = not nameESPEnabled
    nameToggleButton.Text = nameESPEnabled and "ON" or "OFF"
    nameToggleButton.BackgroundColor3 = nameESPEnabled and Color3.fromRGB(0,     150,     0) or Color3.fromRGB(150,     0,     0)
end)

local distanceToggleLabel = Instance.new("TextLabel")
distanceToggleLabel.Size = UDim2.new(0,     150,     0,     30)
distanceToggleLabel.Position = UDim2.new(0,     0,     0,     120)
distanceToggleLabel.BackgroundTransparency = 1
distanceToggleLabel.Text = "Distance ESP:     "
distanceToggleLabel.TextColor3 = Color3.fromRGB(220,     220,     220)
distanceToggleLabel.TextSize = 14
distanceToggleLabel.Font = Enum.Font.SourceSans
distanceToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
distanceToggleLabel.Parent = mainTab

local distanceToggleButton = Instance.new("TextButton")
distanceToggleButton.Size = UDim2.new(0,     80,     0,     30)
distanceToggleButton.Position = UDim2.new(0,     160,     0,     120)
distanceToggleButton.BackgroundColor3 = Color3.fromRGB(0,     150,     0)
distanceToggleButton.Text = "ON"
distanceToggleButton.TextColor3 = Color3.fromRGB(255,     255,     255)
distanceToggleButton.TextSize = 14
distanceToggleButton.Font = Enum.Font.SourceSans

local distanceToggleCorner = Instance.new("UICorner")
distanceToggleCorner.CornerRadius = UDim.new(0,     5)
distanceToggleCorner.Parent = distanceToggleButton

local distanceToggleStroke = Instance.new("UIStroke")
distanceToggleStroke.Color = Color3.fromRGB(100,     100,     100)
distanceToggleStroke.Thickness = 1
distanceToggleStroke.Parent = distanceToggleButton

distanceToggleButton.Parent = mainTab

distanceToggleButton.MouseButton1Click:   Connect(function()
    distanceESPEnabled = not distanceESPEnabled
    distanceToggleButton.Text = distanceESPEnabled and "ON" or "OFF"
    distanceToggleButton.BackgroundColor3 = distanceESPEnabled and Color3.fromRGB(0,     150,     0) or Color3.fromRGB(150,     0,     0)
end)

local hitboxLabel = Instance.new("TextLabel")
hitboxLabel.Size = UDim2.new(0,     150,     0,     30)
hitboxLabel.Position = UDim2.new(0,     0,     0,     160)
hitboxLabel.BackgroundTransparency = 1
hitboxLabel.Text = "Custom Hitbox:     "
hitboxLabel.TextColor3 = Color3.fromRGB(220,     220,     220)
hitboxLabel.TextSize = 14
hitboxLabel.Font = Enum.Font.SourceSans
hitboxLabel.TextXAlignment = Enum.TextXAlignment.Left
hitboxLabel.Parent = mainTab

local hitboxButton = Instance.new("TextButton")
hitboxButton.Size = UDim2.new(0,     80,     0,     30)
hitboxButton.Position = UDim2.new(0,     160,     0,     160)
hitboxButton.BackgroundColor3 = Color3.fromRGB(150,     0,     0)
hitboxButton.Text = "OFF"
hitboxButton.TextColor3 = Color3.fromRGB(255,     255,     255)
hitboxButton.TextSize = 14
hitboxButton.Font = Enum.Font
